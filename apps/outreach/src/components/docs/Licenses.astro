---
import { licenses } from '@opendatacapture/licenses';
import type { ApprovedLicense } from '@opendatacapture/licenses';

const approvedLicenseIds: ApprovedLicense[] = [
  '0BSD',
  'Apache-2.0',
  'BSD-1-Clause',
  'BSD-2-Clause',
  'BSD-3-Clause',
  'CC0-1.0',
  'ISC',
  'MIT',
  'MIT-0',
  'Unlicense',
  'WTFPL'
];

const approvedLicenses = Array.from(licenses.entries())
  .filter(([id]) => approvedLicenseIds.includes(id as any))
  .map(([id, license]) => ({ id, ...license }))
  .sort((a, b) => a.name.localeCompare(b.name));

const openSourceNonApprovedLicenses = Array.from(licenses.entries())
  .filter(([id, license]) => !approvedLicenseIds.includes(id as any) && license.isOpenSource)
  .map(([id, license]) => ({ id, ...license }))
  .sort((a, b) => a.name.localeCompare(b.name));

const proprietaryLicenses = Array.from(licenses.entries())
  .filter(([id, license]) => !license.isOpenSource)
  .map(([id, license]) => ({ id, ...license }))
  .sort((a, b) => a.name.localeCompare(b.name));
---

<div class="space-y-8">
  <section>
    <h3>Licenses Approved for Inclusion in ODC Repository</h3>
    <p class="mb-4 text-slate-700">
      The following licenses are pre-approved for direct inclusion and public distribution:
    </p>
    <ul class="tracking-tight">
      {
        approvedLicenses.map((license) => (
          <li>
            <a
              class="font-bold hover:underline"
              target="_blank"
              rel="noopener noreferrer"
              href={license.reference}
              style="text-decoration-line: none;"
            >
              {license.name}
            </a>
          </li>
        ))
      }
    </ul>
    <p class="text-slate-700">Please note that instruments in the public domain instruments are also permitted.</p>
  </section>
  <section>
    <h3>Open Source Licenses (Review Required)</h3>
    <p class="mb-4 text-slate-700">
      These open source licenses are acceptable for public distribution but require team review before inclusion:
    </p>
    <ul class="tracking-tight">
      {
        openSourceNonApprovedLicenses.map((license) => (
          <li>
            <a
              class="font-bold hover:underline"
              target="_blank"
              rel="noopener noreferrer"
              href={license.reference}
              style="text-decoration-line: none;"
            >
              {license.name}
            </a>
          </li>
        ))
      }
    </ul>
  </section>
  <section>
    <h3>Proprietary and Non-Free Licenses</h3>
    <p class="mb-4 text-slate-700">
      These licenses may not be published publicly by our team. Licenses with commercial use restrictions are considered
      non-free, consistent with FSF and OSI definitions:
    </p>
    <ul class="tracking-tight">
      {
        proprietaryLicenses.map((license) => (
          <li>
            <a
              class="font-bold hover:underline"
              target="_blank"
              rel="noopener noreferrer"
              href={license.reference}
              style="text-decoration-line: none;"
            >
              {license.name}
            </a>
          </li>
        ))
      }
    </ul>
  </section>
</div>
